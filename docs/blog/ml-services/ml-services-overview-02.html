

<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>[第5回] Amazon SageMaker の基本的な使い方を理解する (1) &mdash; technical notes  ドキュメント</title>
  

  
  <link rel="stylesheet" href="../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="[第6回] Amazon SageMaker の基本的な使い方を理解する (2)" href="ml-services-overview-03.html" />
    <link rel="prev" title="[第4回] ML サービスの全体像を把握する" href="ml-services-overview-01.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> technical notes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../aws/aws.html">AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloudnative/cloudnative.html">Cloud Native</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment/environment.html">環境構築</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/testing.html">テスト</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../case/case.html">事例</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../blog.html">AWS ではじめる機械学習</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../summary/introduction.html">[第1回] AWS ではじめる機械学習</a></li>
<li class="toctree-l2"><a class="reference internal" href="../summary/overview.html">[第2回] AWS の機械学習サービスとは</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-services/ai-services-overview.html">[第3回] AI サービスの全体像を把握する</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml-services-overview-01.html">[第4回] ML サービスの全体像を把握する</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">[第5回] Amazon SageMaker の基本的な使い方を理解する (1)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">はじめに</a></li>
<li class="toctree-l3"><a class="reference internal" href="#amazon-sagemaker">実際に Amazon SageMaker を使う</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">チュートリアルの概要</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">これから数回の記事で実施すること</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">注意事項</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">ステップ 1: Amazon SageMaker コンソールにログインする</a></li>
<li class="toctree-l4"><a class="reference internal" href="#amazon-sagemaker-notebook-instance">ステップ 2: Amazon SageMaker notebook instance を作成する</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">まとめ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">著者紹介</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ml-services-overview-03.html">[第6回] Amazon SageMaker の基本的な使い方を理解する (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml-services-overview-04.html">[第7回] Amazon SageMaker の基本的な使い方を理解する (3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml-services-overview-05.html">[第8回] Amazon SageMaker の基本的な使い方を理解する (4)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">technical notes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../blog.html">AWS ではじめる機械学習</a> &raquo;</li>
        
      <li>[第5回] Amazon SageMaker の基本的な使い方を理解する (1)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/blog/ml-services/ml-services-overview-02.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="amazon-sagemaker-1">
<h1>[第5回] Amazon SageMaker の基本的な使い方を理解する (1)<a class="headerlink" href="#amazon-sagemaker-1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="id1">
<h2>はじめに<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://news.mynavi.jp/itsearch/article/devsoft/4983">前回</a> は、ML サービスおよび Amazon SageMaker の概要と利用方法についてご説明させていただきました。</div>
<div class="line">図を用いて「開発」「学習」「推論」の流れを説明しましたが、今回から数回の記事では、実際に Amazon SageMaker を使ってみたいと思います。</div>
<div class="line">下記を理解していただくことを目標に解説をしていきます。</div>
</div>
<ul class="simple">
<li><p>Amazon SageMaker を使って実際に「開発」を始めるまでの準備作業の流れがわかる。</p></li>
<li><p>Amazon SageMaker を使って、「開発」「学習」「推論」の流れがわかる。</p></li>
</ul>
</div>
<div class="section" id="amazon-sagemaker">
<h2>実際に Amazon SageMaker を使う<a class="headerlink" href="#amazon-sagemaker" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference external" href="https://aws.amazon.com/jp/getting-started/hands-on/build-train-deploy-machine-learning-model-sagemaker/">「機械学習モデルの構築およびトレーニング、デプロイ with Amazon SageMaker」</a> というチュートリアルがありますので、これをベースに進めたいと思います。</p>
<div class="section" id="id3">
<h3>チュートリアルの概要<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>今回利用するチュートリアルの概要を下記に示します。</p>
<ul class="simple">
<li><p>Amazon SageMaker を使って、「開発」「学習」「推論」の一連の流れを体験できるものである。</p></li>
<li><p>学習・推論に利用するデータは、カリフォルニア大学アーバイン校 (UCI) が公開しているオープンデータを利用する。
「<a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Bank+Marketing">Bank Marketing Data Set</a>」と呼ばれる「ポルトガルの銀行マーケティングキャンペーン」のデータを利用する。</p></li>
<li><p>このデータはポルトガルの金融機関が顧客に電話によるダイレクトマーケティングキャンペーンを行った際のデータが記録されている。</p></li>
<li><p>データには大きく2種類の情報が記録されている。</p>
<ul>
<li><p>データ 1：「年齢」や「職業」といった顧客の属性情報</p></li>
<li><p>データ 2：ダイレクトマーケティングを行った結果、その顧客が定期預金を申し込んだか否かのフラグ</p></li>
</ul>
</li>
<li><p>「データ 1」から機械学習アルゴリズムによって何らかのパターンを見出して、これから営業をかける顧客 (「データ 2」が未知の顧客) の中から「定期預金を申し込む見込みのある顧客」を予測して営業活動に役立てる。</p></li>
</ul>
<p>機械学習を使って見込み顧客を予測ができることにより、営業活動を効率化することができます。つまり、<strong>無策に顧客名簿の上から順に営業をかけるよりも顧客を獲得できる可能性が高まるということであり、機械学習を導入する意義はここにあります。</strong></p>
<div class="line-block">
<div class="line">ここでは、顧客の属性データから顧客が定期預金を「申し込む」か「申し込まないか」の二値分類を行います。</div>
<div class="line">Amazon SageMaker の組み込みアルゴリズムとして提供されている「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/xgboost-72.html">XGBoost リリース 0.72</a>」という機械学習アルゴリズムを利用します。</div>
<div class="line">組み込みアルゴリズムとして提供されている XGBoost は「0.90-1」「0.90-2」「1.0-1」というより新しいバージョンも提供されていますが、ここではチュートリアルに従って「0.72」を利用します。</div>
<div class="line">新しいバーションの XGBoost について知りたい方は「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/xgboost.html">XGBoost アルゴリズム</a>」をご参照ください。</div>
</div>
</div>
<div class="section" id="id4">
<h3>これから数回の記事で実施すること<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>今回利用するチュートリアルは 30 分以内に実施可能な簡単な内容ですが、下記を理解できるよう注意しながら詳しく解説を進めていきます。</p>
<ul class="simple">
<li><p>「自分が Amazon SageMaker を使って今何をしているのか」</p></li>
<li><p>「Amazon SageMaker が背後でどのような処理が行っているか」</p></li>
</ul>
<div class="line-block">
<div class="line">解説のボリュームが多いため、これからの 4 回に渡って解説を行っていきます。</div>
<div class="line">解説はチュートリアルの流れに沿って進めていきますが、途中で現在地がわからなくなってしまった場合は下記の表をご参照ください。</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>工程</p></th>
<th class="head"><p>ステップ</p></th>
<th class="head"><p>枝番</p></th>
<th class="head"><p>実施内容</p></th>
<th class="head"><p>連載回</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>開発</p></td>
<td><p>1</p></td>
<td></td>
<td><p>Amazon SageMaker コンソールにログインする</p></td>
<td><p>第 5 回</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>2</p></td>
<td></td>
<td><p>Amazon SageMaker notebook instance を作成する</p></td>
<td><p>第 5 回</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>3</p></td>
<td></td>
<td><p>データの準備</p></td>
<td><p>第 6 回</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>3a, 3b</p></td>
<td><p>ノートブックを起動する</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>3c</p></td>
<td><p>ノートブックの利用準備をする</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>3d</p></td>
<td><p>S3 バケットを作成する</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>3e</p></td>
<td><p>学習・推論に利用するデータをダウンロードする</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>3f</p></td>
<td><p>データを分割する</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>学習</p></td>
<td><p>4</p></td>
<td></td>
<td><p>データからのモデルのトレーニング</p></td>
<td><p>第 7 回</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>4a</p></td>
<td><p>学習データを S3 バケットにアップロードする</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>4b</p></td>
<td><p>学習の設定をする</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>4c</p></td>
<td><p>学習を行う</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>推論</p></td>
<td><p>5</p></td>
<td></td>
<td><p>モデルのデプロイ</p></td>
<td><p>第 8 回</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>5a</p></td>
<td><p>推論エンドポイントを作成して、モデルをデプロイする</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>5b</p></td>
<td><p>推論を行う</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>6</p></td>
<td></td>
<td><p>モデルの性能評価</p></td>
<td><p>第 8 回</p></td>
</tr>
<tr class="row-even"><td><p>後片付け</p></td>
<td><p>7</p></td>
<td></td>
<td><p>リソースを終了する</p></td>
<td><p>第 8 回</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id5">
<h3>注意事項<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>今回の記事の内容を実施する際の注意事項を下記に示します。</p>
<ul>
<li><p><a class="reference external" href="https://news.mynavi.jp/itsearch/article/devsoft/4983">第 4 回</a>  の記事で「開発」「学習」「推論」の流れを示しました。概ね同じ流れであるものの、チュートリアルの手順とは多少前後する箇所があるのでご注意ください。</p></li>
<li><p>記事で示す画面イメージや手順は、2020年7月11日時点のものとなります。仕様変更などにより表示内容や設定値に変更が入る可能性がありますので、予めご了承ください。</p></li>
<li><p>想定外の影響を避けるため、本番環境 (商用サービスが稼働する AWS アカウント) ではなく、開発環境や検証環境で実施してください。</p></li>
<li><p>AWS アカウントを持っていない場合は、「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/gs-set-up.html">Amazon SageMaker をセットアップします</a>」を参照して取得・セットアップをしてください。
今回は Amazon SageMaker Studio は利用しないため、下記の 2 つの手順を実施してください。</p>
<ul class="simple">
<li><p>「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/gs-account.html">AWS アカウントを作成する</a>」</p></li>
<li><p>「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/gs-account-user.html">IAM 管理者ユーザーおよびグループの作成</a>」</p></li>
</ul>
</li>
<li><div class="line-block">
<div class="line">チュートリアルでは下記の 4 つのいずれかのリージョンで作業する前提となっています。</div>
<div class="line">この記事では、<strong>「米国東部 (バージニア北部)」</strong> で実施しています。</div>
</div>
<ul class="simple">
<li><p>us-west-2: 米国西部 (オレゴン)</p></li>
<li><p>us-east-1: 米国東部 (バージニア北部)</p></li>
<li><p>us-east-2 : 米国東部 (オハイオ)</p></li>
<li><p>eu-west-1: 欧州 (アイルランド)</p></li>
</ul>
</li>
<li><p>ノートブックインスタンスの Python と主要なパッケージのバージョンは下記です。</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>名前</p></th>
<th class="head"><p>バージョン</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Python</p></td>
<td><p>3.6.10</p></td>
</tr>
<tr class="row-odd"><td><p>NumPy</p></td>
<td><p>1.18.1</p></td>
</tr>
<tr class="row-even"><td><p>Pandas</p></td>
<td><p>1.0.3</p></td>
</tr>
<tr class="row-odd"><td><p>AWS SDK for Python (Boto3)</p></td>
<td><p>1.14.16</p></td>
</tr>
<tr class="row-even"><td><p>Amazon SageMaker SDK for Python</p></td>
<td><p>1.67.1.post0</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>XGBoost は組み込みアルゴリズムとして提供されている「<a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/xgboost-72.html">XGBoost リリース 0.72</a>」を利用します。</p></li>
<li><p><strong>この記事の内容を実施すると数百円程度の課金が発生する可能性があります。無用な課金を避けるためには作成したリソースの削除が必要ですが、「後片付け」の手順は第 8 回に掲載予定です。あまり期間を開けずに掲載する予定であるため、課金を避けたい方は第 7 回の掲載後に試してください。</strong></p></li>
</ul>
</div>
<div class="section" id="id9">
<h3>ステップ 1: Amazon SageMaker コンソールにログインする<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>AWS マネジメントコンソールにログインして、Amazon SageMaker のコンソールに移動します。</p>
<a class="reference internal image-reference" href="../../_images/amazon-sagemaker-tutorial-step1.png"><img alt="../../_images/amazon-sagemaker-tutorial-step1.png" src="../../_images/amazon-sagemaker-tutorial-step1.png" style="width: 900px;" /></a>
<div class="section" id="id10">
<h4>実施手順<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>AWS マネジメントコンソールに自身の IAM ユーザでログインします。</p>
<a class="reference internal image-reference" href="../../_images/aws-management-console.png"><img alt="../../_images/aws-management-console.png" src="../../_images/aws-management-console.png" style="width: 900px;" /></a>
<p>リージョンは「 <strong>米国東部 (バージニア北部)</strong> 」を利用しますので、その他のリージョンにいる場合は AWS マネジメントコンソールの右上のプルダウンメニューから移動してください。</p>
<a class="reference internal image-reference" href="../../_images/region-check.png"><img alt="../../_images/region-check.png" src="../../_images/region-check.png" style="width: 600px;" /></a>
<div class="line-block">
<div class="line">それでは、Amazon SageMaker に移動します。</div>
<div class="line">「サービスを検索する」の箇所にある検索バーに「sage」程度を入れると、「Amazon SageMaker」が登場しますので、これをクリックして移動します。</div>
</div>
<a class="reference internal image-reference" href="../../_images/search-sagemaker.png"><img alt="../../_images/search-sagemaker.png" src="../../_images/search-sagemaker.png" style="width: 900px;" /></a>
<p>初めて Amazon SageMaker に接続する際は上の機能説明のページに移動します。</p>
<a class="reference internal image-reference" href="../../_images/sagemaker-initial.png"><img alt="../../_images/sagemaker-initial.png" src="../../_images/sagemaker-initial.png" style="width: 900px;" /></a>
<p>2回目以降はしたのダッシュボードページに移動すると思いますが、どちらでも問題ありません。</p>
<a class="reference internal image-reference" href="../../_images/sagemaker-dashboard.png"><img alt="../../_images/sagemaker-dashboard.png" src="../../_images/sagemaker-dashboard.png" style="width: 900px;" /></a>
</div>
</div>
<div class="section" id="amazon-sagemaker-notebook-instance">
<h3>ステップ 2: Amazon SageMaker notebook instance を作成する<a class="headerlink" href="#amazon-sagemaker-notebook-instance" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>学習・推論用のコードの開発環境となる「ノートブックインスタンス」を作成していきます。</p>
<a class="reference internal image-reference" href="../../_images/amazon-sagemaker-tutorial-step2.png"><img alt="../../_images/amazon-sagemaker-tutorial-step2.png" src="../../_images/amazon-sagemaker-tutorial-step2.png" style="width: 900px;" /></a>
<div class="section" id="id11">
<h4>実施手順<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">左側の折りたたみメニューの「<strong>ノートブック</strong>」をクリックして開き、「<strong>ノートブックインスタンス</strong>」をクリックします。</div>
<div class="line">ダッシュボードにいる場合は、画面中央の「概要」の中にある「<strong>ノートブックインスタンス</strong>」をクリックしても構いません。</div>
</div>
<a class="reference internal image-reference" href="../../_images/sagemaker-dashboard-notebook.png"><img alt="../../_images/sagemaker-dashboard-notebook.png" src="../../_images/sagemaker-dashboard-notebook.png" style="width: 900px;" /></a>
<div class="line-block">
<div class="line">ノートブックインスタンスの画面に移動します。</div>
<div class="line">現在はノートブックインスタンスが存在しませんが、ここにそのリージョンに存在するノートブックインスタンスの一覧が表示されます。</div>
<div class="line">「<strong>ノートブックインスタンスの作成</strong>」をクリックします。</div>
</div>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-initial.png"><img alt="../../_images/sagemaker-notebook-instance-initial.png" src="../../_images/sagemaker-notebook-instance-initial.png" style="width: 900px;" /></a>
<p>ノートブックインスタンスの作成画面に移動します。</p>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-create.png"><img alt="../../_images/sagemaker-notebook-instance-create.png" src="../../_images/sagemaker-notebook-instance-create.png" style="width: 900px;" /></a>
<div class="line-block">
<div class="line">ノートブックインスタンス作成時の設定項目を下記の表に示します。</div>
<div class="line">今回は簡単なチュートリアルですので、<strong>原則としてデフォルト値を設定</strong> します。</div>
<div class="line">各設定値の説明を簡単に記しますので、実際の業務で利用する際は参考にしてください。</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>大分類</p></th>
<th class="head"><p>小分類</p></th>
<th class="head"><p>設定値名</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>デフォルト値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ノートブックインスタンス設定</p></td>
<td></td>
<td><p>ノートブックインスタンス名</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスの名前を設定する。</strong></div>
<div class="line"><br /></div>
<div class="line">最大 63 文字まで設定可能。英数字もしくはハイフン (-) の利用が可能。</div>
<div class="line">1つのAWS リージョンのアカウント内で一意である必要がある。</div>
</div>
</td>
<td><div class="line-block">
<div class="line">なし</div>
<div class="line">(今回は「mynotebook」と設定)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>ノートブックインスタンスのタイプ</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスのタイプを設定する。</strong></div>
<div class="line"><br /></div>
<div class="line">ノートブックインスタンスでの作業はデータの簡単な前処理とコーディングがメインであり、学習や推論は行わない。</div>
<div class="line">まずはデフォルトの「ml.t2.medium」など <strong>小さいインスタンス</strong> で試して、CPU やメモリなどのリソース不足が発生した場合にスケールアップもしくは不足するリソースに応じたインスタンスタイプを選択する。</div>
<div class="line">(例)</div>
<div class="line">- CPUを重点的に増やしたい：コンピューティング最適化 (ml.c5 シリーズなど)</div>
<div class="line">- メモリを重点的に増やしたい：メモリの最適化 (ml.r5.シリーズなど)</div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://aws.amazon.com/jp/sagemaker/pricing/instance-types/">「Amazon SageMaker ML インスタンスタイプ」</a></div>
<div class="line">- <a class="reference external" href="https://aws.amazon.com/jp/sagemaker/pricing/">「Amazon SageMaker の料金」</a></div>
</div>
</td>
<td><p>ml.t2.medium</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>Elastic Inference</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスに GPU リソースをアタッチして、ローカル環境での推論テストを高速化する。</strong></div>
<div class="line"><br /></div>
<div class="line">ディープラーニングフレームワークとしては、TensorFlow、 Apache MXNet、PyTorch がサポートされている。</div>
<div class="line">今回のチュートリアルで利用する機械学習アルゴリズム (フレームワーク) は XGBoost であり、GPU は利用する計算はしないため不要である。</div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/ei.html">「Amazon SageMaker Elastic Inference (EI) を使用する」</a></div>
</div>
</td>
<td><p>なし</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>追加設定</p></td>
<td><p>ライフサイクル設定</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスの作成時または起動時に実行するシェルスクリプトを定義する。</strong></div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/notebook-lifecycle-config.html">「ライフサイクル設定スクリプトを使用したノートブックインスタンスをカスタマイズする」</a></div>
</div>
</td>
<td><p>設定なし</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>ボリュームサイズ (GB 単位)</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスにアタッチする汎用ストレージ (SSD) のボリュームのサイズを設定する。</strong></div>
<div class="line"><br /></div>
<div class="line">ボリュームサイズは <strong>5 GB - 16 TB</strong> の範囲で設定可能。</div>
</div>
</td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>アクセス許可と暗号化</p></td>
<td></td>
<td><p>IAM ロール</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスに AWS リソースの操作権限を付与する。</strong></div>
<div class="line"><br /></div>
<div class="line">この表の下に補足情報を記載するので、そちらも参照すること。</div>
</div>
</td>
<td><div class="line-block">
<div class="line">IAM ロールを選択する</div>
<div class="line">(新しい IAM ロールの作成)</div>
</div>
</td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>ルートアクセス - オプション</p></td>
<td><div class="line-block">
<div class="line"><strong>有効化によりノートブックインスタンスのすべてのユーザーに管理者権限を付与する。</strong></div>
<div class="line"><br /></div>
<div class="line">ノートブックインスタンス上のすべてのファイルにアクセスして編集できる権限が与えられる。</div>
</div>
</td>
<td><p>有効化 - ノートブックへのルートアクセス権をユーザーに付与する</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>暗号化キー - オプション</p></td>
<td><div class="line-block">
<div class="line"><strong>AWS Key Management Service (KMS) の暗号鍵を利用して、ノートブックインスタンスにアタッチする汎用ストレージを暗号化する。</strong></div>
<div class="line"><br /></div>
<div class="line">セキュリティ要件で汎用ストレージの暗号化が必要な場合は設定する。</div>
<div class="line">別途、AWS KMS の利用料が必要となる点に注意する。</div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://aws.amazon.com/jp/kms/pricing/">「AWS Key Management Service の料金」</a></div>
</div>
</td>
<td><p>カスタム暗号化なし</p></td>
</tr>
<tr class="row-even"><td><p>ネットワーク - オプション</p></td>
<td></td>
<td><p>VPC - オプション</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスの VPC への配置を設定する。</strong></div>
<div class="line"><br /></div>
<div class="line">セキュリティ要件などでノートブックインスタンスをユーザ管理の VPC 内に配置する必要がある場合に設定する。</div>
<div class="line">他の AWS サービスに接続する場合はインターネット接続もしくは接続したいサービスの VPC エンドポイントが必要となる点に注意すること。</div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/appendix-notebook-and-internet-access.html">「ノートブックインスタンスを VPC のリソースに接続する」</a></div>
</div>
</td>
<td><p>非 VPC</p></td>
</tr>
<tr class="row-odd"><td><p>Git リポジトリ - オプション</p></td>
<td><p>デフォルトのリポジトリ</p></td>
<td><p>リポジトリ</p></td>
<td><div class="line-block">
<div class="line"><strong>ノートブックインスタンスの作成時に自動で /home/ec2-user/SageMaker 直下に登録した Git リポジトリをクローンする。</strong></div>
<div class="line"><br /></div>
<div class="line">AWS CodeCommit や GitHub の Git リポジトリを登録してノートブックインスタンスの作成時に自動で /home/ec2-user/SageMaker 直下に クローンして、手動でクローンする手間を省くことができる。</div>
<div class="line">デフォルトのリポジトリを1つ、追加のリポジトリを最大3つ設定可能。</div>
<div class="line"><br /></div>
<div class="line">(参考)</div>
<div class="line">- <a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/nbi-git-repo.html#nbi-git-create">「Git リポジトリを Amazon SageMaker のノートブックインスタンスに関連付ける」</a></div>
</div>
</td>
<td><p>なし</p></td>
</tr>
<tr class="row-even"><td><p>タグ - オプション</p></td>
<td></td>
<td><p>キー、値</p></td>
<td><div class="line-block">
<div class="line"><strong>キーバリュー形式で値を設定する。</strong></div>
<div class="line"><br /></div>
<div class="line">(例)</div>
<div class="line">- Name タグ (Name: <em>&lt;notebook_instance_name&gt;</em>)</div>
<div class="line">- 環境タグ (Environment: Production)</div>
</div>
</td>
<td><p>なし</p></td>
</tr>
</tbody>
</table>
<p>ここで、ノートブックインスタンスに付与する IAM ロールに関して補足します。</p>
<div class="line-block">
<div class="line">IAM ロールは AWS のリソースに操作権限を与えるために利用します。</div>
<div class="line">例えば、学習用データの取得のためにノートブックインスタンスから Amazon S3 のバケットにアクセスが必要となります。</div>
</div>
<div class="line-block">
<div class="line">IAM ユーザに紐づく認証情報として「アクセスキー ID」と「シークレットキー」がありますが、これをソースコードに <strong>ハードコーディングすることはアンチパターン</strong> となります。</div>
<div class="line">Git リポジトリのコードとしてパブリックなリポジトリに公開してしまった場合、数十分程度でその情報が搾取されるとの指摘もありますので十分に注意してください。</div>
<div class="line">IAM ロールに操作権限を定義してノートブックインスタンスに付与することで、具体的な認証情報を記述せずに操作権限を付与することができます。</div>
</div>
<div class="line-block">
<div class="line">ノートブックインスタンスの作成の画面に従って IAM ロールを新規作成する場合は、「<strong>AmazonSageMakerFullAccess</strong>」を権限として持つ IAM ロールを作成することになります。</div>
<div class="line"><a class="reference external" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/sagemaker-roles.html#sagemaker-roles-amazonsagemakerfullaccess-policy">「AmazonSageMakerFullAccess ポリシー」</a> に記載されている操作権限が付与されます。</div>
</div>
<div class="line-block">
<div class="line">IAM ロールの作成時に下記に示すウィンドウが表示されます。</div>
<div class="line">この条件に当てはまる Amazon S3 のバケットとオブジェクト (ファイル) の操作権限が与えられる点に注意してください。</div>
<div class="line">問題がなければ、「ロールの作成」をクリックして作成します。</div>
</div>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-create-iamrole.png"><img alt="../../_images/sagemaker-notebook-instance-create-iamrole.png" src="../../_images/sagemaker-notebook-instance-create-iamrole.png" style="width: 900px;" /></a>
<p>ノートブックインスタンスの設定が完了したら、画面の最下部にある「<strong>ノートブックインスタンスの作成</strong>」をクリックします。</p>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-create-instance.png"><img alt="../../_images/sagemaker-notebook-instance-create-instance.png" src="../../_images/sagemaker-notebook-instance-create-instance.png" style="width: 900px;" /></a>
<div class="line-block">
<div class="line">設定値に問題がなければ画面が切り替わり、「<strong>成功! ノートブックインスタンスが作成されています。</strong>」と表示されます。</div>
<div class="line">数分間待って、「ステータス」が「<strong>Pending</strong>」から「<strong>InService</strong>」に変わると、ノートブックインスタンスの作成が完了です。</div>
</div>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-create-pending.png"><img alt="../../_images/sagemaker-notebook-instance-create-pending.png" src="../../_images/sagemaker-notebook-instance-create-pending.png" style="width: 900px;" /></a>
<a class="reference internal image-reference" href="../../_images/sagemaker-notebook-instance-create-inservice.png"><img alt="../../_images/sagemaker-notebook-instance-create-inservice.png" src="../../_images/sagemaker-notebook-instance-create-inservice.png" style="width: 900px;" /></a>
</div>
</div>
</div>
<div class="section" id="id14">
<h2>まとめ<a class="headerlink" href="#id14" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">今回の記事では、Amazon SageMaker のチュートリアルをベースにして、ノートブックインスタンスの作成までの手順をご説明させていただきました。</div>
<div class="line">次回は学習・推論に利用するデータの準備を行います。</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="id15">
<h2>著者紹介<a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h2>
<a class="reference internal image-reference" href="../../_images/myphoto2.jpg"><img alt="../../_images/myphoto2.jpg" class="align-right" src="../../_images/myphoto2.jpg" style="width: 157.65px; height: 225.0px;" /></a>
<p>菊地 貴彰 (KIKUCHI Takaaki)</p>
<p>株式会社 NTT データ システム技術本部 デジタル技術部 Agile プロフェッショナル担当</p>
<p>大学・大学院では、機械学習を専攻。
ベイズ的枠組みを用いて、複数の遺伝子のデータから遺伝子どうしの相互作用ネットワークの推定に関する研究を行った。</p>
<p>株式会社NTTデータに入社後は、法人や金融のシステム開発のシステム基盤担当としてキャリアを積み、
現在はデジタル技術や Agile 開発を専門に扱う組織でシステム開発全般を担当する。
2019, 2020 APN AWS Top Engineers, Japan APN Ambassador 2020 に選出。</p>
<p>本連載の内容に対するご意見・ご質問は twitter: &#64;kikuchitk7 まで。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ml-services-overview-03.html" class="btn btn-neutral float-right" title="[第6回] Amazon SageMaker の基本的な使い方を理解する (2)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ml-services-overview-01.html" class="btn btn-neutral float-left" title="[第4回] ML サービスの全体像を把握する" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; 著作権 2019, kikuchitk7

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>