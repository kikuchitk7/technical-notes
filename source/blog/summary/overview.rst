[第2回] AWS の機械学習サービスとは
=====================================

はじめに
-----------------
`前回 <https://news.mynavi.jp/itsearch/article/cloud/4722>`_ は、本連載の背景についてご説明させていただき、想定読者や目指す状態などを設定しました。今回から AWS の機械学習サービスの具体的な内容を見ていきたいと思います。

| ところで、2019年12月1日〜6日にアメリカのラスベガスにて AWS の最大のイベントである `AWS re:Invent 2019 <https://reinvent.awsevents.com/>`_ が開催され、全部で70を超える新サービスが発表されました。
| 注目すべきなのは、機械学習サービスだけで20の新サービスが発表されており、全体の3割程度を占めている点です。AWS 社がサービスの開発に注力していることが伺え、今後も多数のサービスが登場することが予想されます。

後続の記事では、新サービスも含めて機械学習サービス全体を扱っていきますが、AWS re:Invent 2019 の新サービスについていち早く知りたい方は、Black Belt Online Seminar 「AWS re:Invent 2019 アップデート速報」の `[動画 (YouTube)] <https://www.youtube.com/watch?v=v9bu2LYN0PY&feature=youtu.be>`_ もしくは `[資料 (SlideShare)] <https://www.slideshare.net/AmazonWebServicesJapan/20191206-aws-black-belt-online-seminar-aws-reinvent-202177403>`_ をご確認ください。

さて、本題に戻り、今回の記事の目標を下記に示します。

今回の目標
^^^^^^^^^^^^^^^^^^^
- AWS の機械学習サービスの3種類のサービスとそれぞれの概要がわかる。
- 機械学習を活用する際の注意事項がわかる。


AWS の機械学習サービスとは
----------------------------
AWS の機械学習サービスについて整理をしていきます。

機械学習分野における AWS のミッション
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
| AWS 社はどのようなミッションの元で機械学習サービスを提供しているのでしょうか？
| それは機械学習サービスの製品紹介ページにて宣言されている通り「すべての開発者に機械学習の恩恵を」です。
| すなわち、機械学習を専門に扱う研究者やエンジニアだけでなく、これから機械学習をビジネスに取り入れたいといった機械学習に関する専門的な知識を持たないエンジニアに向けたサービスも用意されています。

.. image:: ../../../images/機械学習分野におけるAWSのミッション.png

(出典：`機械学習サービスの製品紹介ページ <https://aws.amazon.com/jp/machine-learning/?nc1=h_ls>`_)

機械学習サービスの種類
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
| AWS の機械学習サービスのラインナップ (ML スタック) を下記の図に示します。
| `前回 <https://news.mynavi.jp/itsearch/article/cloud/4722>`_ の記事でも同様の図を示しましたが、AWS re:Invent 2019 にて新サービスが追加されたため、内容が異なっている点に注意してください。

.. image:: ../../../images/AWSのMLスタック_2019.png

(出典：2019年12月12日開催 「AWS re:Invent 2019 re:Cap | AI/ML」 の資料より)

| 機械学習サービスは、大きく「AI サービス」「ML サービス」「ML フレームワークとインフラストラクチャ」の3種類に分けることができます。
| それぞれの機械学習サービスの特徴を下記の表に簡単にまとめます。

.. list-table::
    :widths: 5, 5, 5
    :header-rows: 1

    * - サービス名
      - サービスの特徴
      - 導入の難易度
    * - AI サービス
      - * | AWS がユースケースごとに用意したサービスと自身の解決したい問題・課題とマッチする人向けのサービス。
          | (例) 機械翻訳がしたい：Amazon Translate、商品の在庫を予測したい：Amazon Forecast など
        * | 学習済の機械学習モデル、もしくは、機械学習モデルを生成する仕組みが AWS から提供される。
          | 利用者が考える部分が少なくて済むため、導入の難易度は最も低い。
        * | 上記の理由で「機械学習の深い知識なしに利用可能」である。
      - 易
    * - ML サービス
      - * | 機械学習エンジニアやデベロッパ向けのサービス。
          | Amazon SageMaker とその関連機能により、機械学習のプロセス (開発・学習・デプロイ・推論・監視など)
          | を効率良く行うための機能が提供されている。
        * | AWS が用意したビルトインアルゴリズムを利用して機械学習モデルを開発することや
          | 利用者独自のアルゴリズムを元に機械学習モデルを開発するも可能である。
        * | AI サービスと比較すると柔軟性が増す一方で利用者が準備する部分が増えるため、導入の難易度が上がる。
      - 難
    * - | ML フレームワークと
        | インフラストラクチャ
      - * | Amazon SageMaker の実行環境をカスタマイズするためのサービス。
        * | 利用者が好きな ML (機械学習) フレームワークを選択して開発することや
          | 機械学習向けに最適化されたインスタンスを利用して、推論を実行することができる。
      - ー

| 上記の表に示した通り、AI サービスは導入の難易度が低いため、それぞれのサービスのユースケースと使い方を正しく把握できれば、機械学習をビジネスに取り入れることができます。
| 一方で柔軟性に欠けるため、ユースケースや要件が合わない、細かいチューニングを行いたいといった場合は、ML サービス、ML フレームワークとインフラストラクチャで提供されるサービスを利用してカスタマイズします。

機械学習を活用する際の注意事項
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
本連載ではビジネスに機械学習を活用することをテーマとしていますが、機械学習を導入することが必ずしも正解とは限りません。
活用する際の注意事項を下記に5点挙げましたので参考にしていただきたいと思います。

自身のビジネスにおける問題・課題から入っているか？
******************************************************
| 機械学習に限りませんが、自身の「ビジネスにおける問題・課題」から入ることが重要です。すなわち、機械学習を利用することはビジネスで価値を出すための手段であり、機械学習の導入を目的化しないということです。
| 例えば、「機械学習を使ってとりあえず何かをやりたい！」という思いから出発してしまうパターンです。機械学習は技術的なトレンドになっていますので、試してみたい・世の中に流れに遅れを取りたくないなどの理由から導入を検討したいという気持ちは理解できます。
| しかし、手段と目的が逆転した状態で開発を進めてしまうと、利用者に使われないシステムや機能が作られてしまいがちです。技術検証やPoC (Proof of Consent; 概念実証) を実施するにしても、背景にビジネス課題があって、それを確認するために実施するはずです。

まずは自身のビジネスにおける問題・課題を明確にし、機械学習を使うことで生み出されるビジネス価値をはっきりさせることが重要と考えます。

機械学習を使うべき理由が明確になっているか？
*************************************************
| 少数の条件の組み合わせで後続の処理が決まるのであれば、わざわざ機械学習を導入せずに条件分岐(if 文など) を駆使して実装すれば済みます。
| 機械学習モデルの維持や運用には手間がかかる場合が多いので、機械学習を使わずに簡便に対処できるのであれば、使わない方が賢明です。
| なぜなら、本番環境にデプロイした機械学習モデルは、定常的に予測精度を監視して、自社のサービスとして十分な精度を出し続けているかを監視する必要があります。
| 機械学習モデルは、過去のデータから何らかのパターンを抽出 (学習) して、将来を予測します。すなわち、予測する対象がその過去のデータに即した振る舞いをするという前提があります。
| 振る舞いの傾向が変わるなどした場合 (ユーザの購買行動の変化など) は、新たなデータを使って機械学習モデルを再学習させる必要があります。

| しかし、これがEC サイトにおける商品のレコメンド (推薦) のような問題では事情が変わります。
| 商品の数や購入数などを考慮すると購入パターンは無数に存在しますし、同じような好みを持っている人が同じ商品の組み合わせで購入するとは限らないからです。
| このような場合に、機械学習が活躍します。ユーザの購入履歴からユーザの購買行動のパターンを見出し、ユーザが購入してくれる可能性が高いものを推薦することができます。
| 機械学習を使うべき理由が明確になっていれば、プロジェクトの承認者への説得力が増しますし、理由を明確にする過程で調査をするので機械学習に関するノウハウも溜まります。

ビジネス課題とユースケースが合っているか？
**********************************************
| 例えば、Amazon Forecast は時系列データの予測サービスであり、時系列データ以外のものを予測させることはできません。
| AI サービスの場合は利用するサービス、ML サービスの場合は利用する機械学習アルゴリズムのユースケースを正確に把握してビジネス課題とマッチしていることを確認する必要があります。

機械学習モデルが十分な予測精度を出すために十分なデータの量と質が揃えられているか？
**********************************************************************************
| 機械学習モデルは準備したデータを元にして生成されます。
| 機械学習の作業にかかる時間の大半はデータの準備であると言われますが、データの量と質は精度を左右する要因の1つとなります。
| 例えば、クレジットカードの不正検知を教師あり学習により分類したい場合を考えると、不正利用あり/なし (正解データと不正解データ) の両方を用意する必要があります。
| 下記の項目に "No" がある場合は機械学習の導入を考える前にデータの収集から見直した方が良いかもしれません。
| 不正検知のように正常と異常を判別したい場合は、異常を示すデータが正常なデータに比べて少なくなるので、課題になりやすいポイントです。
| なお、必要となるデータ数は場合によって異なるため、交差検定などを用いて精度から判断します。

- 正解データと不正解データのデータ数に偏りがない
- 不正利用の特徴を説明するデータ (購入した商品や取引が発生した場所など) が含まれる
- 十分な量のデータ数が存在する

機械学習モデルの判断の間違いに歯止めが効かせられるか？
*******************************************************
| 機械学習モデルの判断を元にアクションができると、人間が判断をするよりも迅速にアクションができます。
| しかし、機械学習モデルの精度は一般的に100%にはならないので、間違った判断を下すことがあります。
| 上記の不正検知の例でいえば、利用者本人であるにもかかわらず不正利用と判定されて決済処理が行えないという事態が起こり得ます。
| 何度も発生すると、ユーザの満足度低下、場合によっては離反につながってしまいます。
| そのような事態をなくすために、不正利用を検知した場合は登録されている電話番号に自動で確認の電話が掛けるなど機械学習モデルの判断に歯止めを効かせる仕組みを導入しておくと良いと考えられます。


まとめ
--------------
今回の記事では、AWS の機械学習サービスの3種類のサービスとそれぞれの概要、機械学習を活用する際の注意事項についてご説明させていただきました。

次回は、AI サービスとして提供されているサービスの概要やユースケースについて見ていきたいと思います。

+++++++++++

.. include:: ../author/author.rst